(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function a(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(t){if(t.ep)return;t.ep=!0;const n=a(t);fetch(t.href,n)}})();const G=new Map;function p(e,r){G.set(e,r)}function F(e){return G.get(e)}function et(e){const r=G.get(e);return r?r.name:"—"}function $(e){return(r,a)=>{const{width:s,height:t,data:n}=r,c=a.data;for(let o=0;o<t;o++)for(let l=0;l<s;l++){let i=0,d=0,f=0,u=0,h=0;for(let D=-e;D<=e;D++)for(let E=-e;E<=e;E++){const nt=Math.min(s-1,Math.max(0,l+E)),L=(Math.min(t-1,Math.max(0,o+D))*s+nt)*4;i+=n[L],d+=n[L+1],f+=n[L+2],u+=n[L+3],h++}const m=(o*s+l)*4;c[m]=i/h,c[m+1]=d/h,c[m+2]=f/h,c[m+3]=u/h}}}const at=$(2),st=$(4),ot=$(8);function H(e,r,a){return(s,t)=>{const n=s.data,c=t.data;for(let o=0;o<n.length;o+=4)c[o]=e?n[o]:0,c[o+1]=r?n[o+1]:0,c[o+2]=a?n[o+2]:0,c[o+3]=n[o+3]}}function T(e,r,a){return(s,t)=>{const n=s.data,c=t.data;for(let o=0;o<n.length;o+=4){const l=n[o+e],i=n[o+r],d=n[o+a];c[o]=l,c[o+1]=i,c[o+2]=d,c[o+3]=n[o+3]}}}const ct=H(!0,!1,!1),rt=H(!1,!0,!1),it=H(!1,!1,!0),lt=T(1,0,2),dt=T(0,2,1),ut=T(2,1,0);function x(e){return Math.min(255,Math.max(0,Math.round(e)))}function _(e){return(r,a)=>{const s=r.data,t=a.data;for(let n=0;n<s.length;n+=4)t[n]=x((s[n]-128)*e+128),t[n+1]=x((s[n+1]-128)*e+128),t[n+2]=x((s[n+2]-128)*e+128),t[n+3]=s[n+3]}}function q(e){return(r,a)=>{const s=r.data,t=a.data;for(let n=0;n<s.length;n+=4)t[n]=x(s[n]+e),t[n+1]=x(s[n+1]+e),t[n+2]=x(s[n+2]+e),t[n+3]=s[n+3]}}const ht=_(1.5),pt=_(.65),ft=q(25),mt=q(-25);function M(e){return Math.min(255,Math.max(0,Math.round(e)))}const yt=(e,r)=>{const a=e.data,s=r.data,t=1.8,n=1.4,c=-30;for(let o=0;o<a.length;o+=4){let l=a[o],i=a[o+1],d=a[o+2];const f=a[o+3],u=.299*l+.587*i+.114*d;l=M((l-u)*t+u),i=M((i-u)*t+u),d=M((d-u)*t+u),l=M((l-128)*n+128+c),i=M((i-128)*n+128+c),d=M((d-128)*n+128+c),s[o]=l,s[o+1]=i,s[o+2]=d,s[o+3]=f}},gt=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5].map(e=>e/16*255),Dt=(e,r)=>{const{width:a,height:s,data:t}=e,n=r.data;for(let c=0;c<s;c++)for(let o=0;o<a;o++){const l=(c*a+o)*4,i=t[l],d=t[l+1],f=t[l+2],u=.299*i+.587*d+.114*f,h=gt[c%4*4+o%4],m=u>h?255:0;n[l]=m,n[l+1]=m,n[l+2]=m,n[l+3]=t[l+3]}},Mt=[-2,-1,0,-1,1,1,0,1,2];function xt(e,r,a,s,t){const n=Math.min(r-1,Math.max(0,s)),o=(Math.min(a-1,Math.max(0,t))*r+n)*4;return(e[o]+e[o+1]+e[o+2])/3}const vt=(e,r)=>{const{width:a,height:s,data:t}=e,n=r.data;for(let c=0;c<s;c++)for(let o=0;o<a;o++){let l=0;for(let u=-1;u<=1;u++)for(let h=-1;h<=1;h++)l+=xt(t,a,s,o+h,c+u)*Mt[(u+1)*3+(h+1)];const i=Math.round(128+l),d=Math.min(255,Math.max(0,i)),f=(c*a+o)*4;n[f]=d,n[f+1]=d,n[f+2]=d,n[f+3]=t[f+3]}},wt=(e,r)=>{const a=e.data,s=r.data;for(let t=0;t<a.length;t+=4){const n=a[t],c=a[t+1],o=a[t+2],l=Math.round(.299*n+.587*c+.114*o);s[t]=l,s[t+1]=l,s[t+2]=l,s[t+3]=a[t+3]}},bt=(e,r)=>{const a=e.data,s=r.data;for(let t=0;t<a.length;t+=4)s[t]=255-a[t],s[t+1]=255-a[t+1],s[t+2]=255-a[t+2],s[t+3]=a[t+3]},Lt=(e,r)=>{const{width:a,height:s,data:t}=e,n=r.data,c=a>>1,o=s>>1;function l(i,d){const f=Math.min(a-1,Math.max(0,i)),h=(Math.min(s-1,Math.max(0,d))*a+f)*4;return{r:t[h],g:t[h+1],b:t[h+2],a:t[h+3]}}for(let i=0;i<s;i++)for(let d=0;d<a;d++){let f,u;i<o&&d<c?(f=d,u=i):i<o&&d>=c?(f=a-1-d,u=i):i>=o&&d<c?(f=d,u=s-1-i):(f=a-1-d,u=s-1-i);const h=l(f,u),m=(i*a+d)*4;n[m]=h.r,n[m+1]=h.g,n[m+2]=h.b,n[m+3]=h.a}};function K(e){return(r,a)=>{const{width:s,height:t,data:n}=r,c=a.data,o=Math.max(1,e);for(let l=0;l<t;l++)for(let i=0;i<s;i++){const d=Math.min(Math.floor(i/o)*o,s-1),u=(Math.min(Math.floor(l/o)*o,t-1)*s+d)*4,h=(l*s+i)*4;c[h]=n[u],c[h+1]=n[u+1],c[h+2]=n[u+2],c[h+3]=n[u+3]}}}const It=K(4),Et=K(8),Bt=K(16);function St(e,r,a){return .299*e+.587*r+.114*a}const Rt=(e,r)=>{const{width:a,height:s,data:t}=e,n=r.data;for(let c=0;c<s;c++){const o=[];for(let l=0;l<a;l++){const i=(c*a+l)*4,d=t[i],f=t[i+1],u=t[i+2],h=t[i+3];o.push({r:d,g:f,b:u,a:h,l:St(d,f,u)})}o.sort((l,i)=>l.l-i.l);for(let l=0;l<a;l++){const i=o[l],d=(c*a+l)*4;n[d]=i.r,n[d+1]=i.g,n[d+2]=i.b,n[d+3]=i.a}}};function B(e){return Math.min(255,Math.max(0,Math.round(e)))}function X(e){const r=255/(e-1);return(a,s)=>{const t=a.data,n=s.data;for(let c=0;c<t.length;c+=4)n[c]=B(Math.round(t[c]/255*(e-1))*r),n[c+1]=B(Math.round(t[c+1]/255*(e-1))*r),n[c+2]=B(Math.round(t[c+2]/255*(e-1))*r),n[c+3]=t[c+3]}}const Ot=X(4),Pt=X(8),W=4;function S(e,r,a,s,t,n){const c=Math.min(r-1,Math.max(0,s)),o=Math.min(a-1,Math.max(0,t));return e[(o*r+c)*4+n]}const Ut=(e,r)=>{const{width:a,height:s,data:t}=e,n=r.data;for(let c=0;c<s;c++)for(let o=0;o<a;o++){const l=(c*a+o)*4;n[l]=S(t,a,s,o-W,c,0),n[l+1]=S(t,a,s,o,c,1),n[l+2]=S(t,a,s,o+W,c,2),n[l+3]=t[l+3]}};function R(e){return Math.min(255,Math.max(0,Math.round(e)))}function Y(e){return(r,a)=>{const s=r.data,t=a.data;for(let n=0;n<s.length;n+=4){const c=s[n],o=s[n+1],l=s[n+2],i=.299*c+.587*o+.114*l;t[n]=R((c-i)*e+i),t[n+1]=R((o-i)*e+i),t[n+2]=R((l-i)*e+i),t[n+3]=s[n+3]}}}const Ct=Y(1.8),Nt=Y(.4),kt=2,O=.6,zt=(e,r)=>{const{width:a,height:s,data:t}=e,n=r.data;for(let c=0;c<s;c++){const o=c%kt===0;for(let l=0;l<a;l++){const i=(c*a+l)*4;n[i]=t[i],n[i+1]=t[i+1],n[i+2]=t[i+2],n[i+3]=t[i+3],o&&(n[i]=n[i]*O,n[i+1]=n[i+1]*O,n[i+2]=n[i+2]*O)}}};function P(e){return Math.min(255,Math.max(0,Math.round(e)))}const At=(e,r)=>{const a=e.data,s=r.data;for(let t=0;t<a.length;t+=4){const n=a[t],c=a[t+1],o=a[t+2];s[t]=P(.393*n+.769*c+.189*o),s[t+1]=P(.349*n+.686*c+.168*o),s[t+2]=P(.272*n+.534*c+.131*o),s[t+3]=a[t+3]}};function Gt(e){return Math.min(255,Math.max(0,Math.round(e)))}function w(e,r,a,s,t,n){const c=Math.min(r-1,Math.max(0,s)),o=Math.min(a-1,Math.max(0,t));return e[(o*r+c)*4+n]}const $t=(e,r)=>{const{width:a,height:s,data:t}=e,n=r.data;for(let c=0;c<s;c++)for(let o=0;o<a;o++){const l=(c*a+o)*4;for(let i=0;i<3;i++){const d=w(t,a,s,o,c-1,i)*-1+w(t,a,s,o-1,c,i)*-1+w(t,a,s,o,c,i)*5+w(t,a,s,o+1,c,i)*-1+w(t,a,s,o,c+1,i)*-1;n[l+i]=Gt(d)}n[l+3]=t[l+3]}},U=128,Ht=(e,r)=>{const a=e.data,s=r.data;for(let t=0;t<a.length;t+=4)s[t]=a[t]>U?255-a[t]:a[t],s[t+1]=a[t+1]>U?255-a[t+1]:a[t+1],s[t+2]=a[t+2]>U?255-a[t+2]:a[t+2],s[t+3]=a[t+3]},Tt=(e,r)=>{const{width:a,height:s,data:t}=e,n=r.data,c=a>>1,o=s>>1;for(let l=0;l<s;l++)for(let i=0;i<a;i++){const d=i%c*2,u=(l%o*2*a+d)*4,h=(l*a+i)*4;n[h]=t[u],n[h+1]=t[u+1],n[h+2]=t[u+2],n[h+3]=t[u+3]}},Kt=(e,r)=>{const{width:a,height:s,data:t}=e,n=r.data,c=a/2,o=s/2;for(let l=0;l<s;l++)for(let i=0;i<a;i++){const d=(i-c)/c,f=(l-o)/o,h=1-Math.sqrt(d*d+f*f)*.7,m=(l*a+i)*4,D=Math.max(0,h);n[m]=Math.min(255,Math.round(t[m]*D)),n[m+1]=Math.min(255,Math.round(t[m+1]*D)),n[m+2]=Math.min(255,Math.round(t[m+2]*D)),n[m+3]=t[m+3]}};function Wt(){p(1,{name:"Blur light",apply:at}),p(2,{name:"Blur medium",apply:st}),p(3,{name:"Blur heavy",apply:ot}),p(4,{name:"Red channel only",apply:ct}),p(5,{name:"Green channel only",apply:rt}),p(6,{name:"Blue channel only",apply:it}),p(7,{name:"Swap R–G",apply:lt}),p(8,{name:"Swap G–B",apply:dt}),p(9,{name:"Swap R–B",apply:ut}),p(10,{name:"Deep fry",apply:yt}),p(11,{name:"Saturation up",apply:Ct}),p(12,{name:"Saturation down",apply:Nt}),p(13,{name:"Split into 4",apply:Tt}),p(14,{name:"Invert",apply:bt}),p(15,{name:"Grayscale",apply:wt}),p(16,{name:"Pixelate small",apply:It}),p(17,{name:"Pixelate medium",apply:Et}),p(18,{name:"Pixelate large",apply:Bt}),p(19,{name:"Posterize 4 levels",apply:Ot}),p(20,{name:"Posterize 8 levels",apply:Pt}),p(21,{name:"Dither",apply:Dt}),p(22,{name:"Scanlines",apply:zt}),p(23,{name:"RGB shift",apply:Ut}),p(24,{name:"Pixel sort rows",apply:Rt}),p(25,{name:"Sepia",apply:At}),p(26,{name:"Solarize",apply:Ht}),p(27,{name:"Vignette",apply:Kt}),p(28,{name:"Kaleidoscope",apply:Lt}),p(29,{name:"Emboss",apply:vt}),p(30,{name:"Sharpen",apply:$t}),p(31,{name:"Contrast up",apply:ht}),p(32,{name:"Contrast down",apply:pt}),p(33,{name:"Brightness up",apply:ft}),p(34,{name:"Brightness down",apply:mt})}const jt=50;let b=null;const v=[];function V(){return b}function Z(e){b=e}function Ft(){if(!b)return;const e=Xt(b);v.push(e),v.length>jt&&v.shift()}function _t(){if(v.length===0)return!1;const e=v.pop();return e&&(b=e),!0}function qt(){v.length=0}function Xt(e){const r=new ImageData(e.width,e.height);return r.data.set(e.data),r}Wt();const g=document.getElementById("drop-zone"),C=document.getElementById("file-input"),N=document.getElementById("canvas-wrap"),k=document.getElementById("canvas"),z=document.getElementById("input-area"),Yt=document.getElementById("command-display"),j=document.getElementById("canvas-caption"),Vt=6;let y="";const J=k.getContext("2d");if(!J)throw new Error("Canvas 2D not available");const A=J;function Zt(){g.classList.add("hidden"),N.classList.remove("hidden"),z.classList.remove("hidden"),y="",I(),N.focus()}function Q(e){const r=e.naturalWidth,a=e.naturalHeight;k.width=r,k.height=a,A.drawImage(e,0,0);const s=A.getImageData(0,0,r,a);Z(s),qt(),Zt()}function tt(){const e=V();e&&A.putImageData(e,0,0)}function Jt(e){const r=F(e);if(!r)return;const a=V();if(!a)return;Ft();const s=new ImageData(a.width,a.height);r.apply(a,s),Z(s),tt()}function I(){if(Yt.textContent=y,y.length>0){z.classList.add("visible");const e=parseInt(y,10);j.textContent=et(e)}else z.classList.remove("visible"),j.textContent=""}document.addEventListener("keydown",e=>{if(N.classList.contains("hidden"))return;const r=e.target;if(!(r.closest("input")||r.closest("textarea")||r.closest("select"))){if(/^[0-9]$/.test(e.key)){e.preventDefault(),y.length<Vt&&(y+=e.key,I());return}if(e.key==="Enter"){if(e.preventDefault(),y.length===0)return;const a=parseInt(y,10);F(a)&&(Jt(a),y="",I());return}if(e.key==="Backspace"){e.preventDefault(),y.length>0?(y=y.slice(0,-1),I()):_t()&&tt();return}}});C.addEventListener("change",()=>{var s;const e=(s=C.files)==null?void 0:s[0];if(!(e!=null&&e.type.startsWith("image/")))return;const r=URL.createObjectURL(e),a=new Image;a.onload=()=>{Q(a),URL.revokeObjectURL(r)},a.src=r});g.addEventListener("click",e=>{e.target.tagName!=="INPUT"&&C.click()});g.addEventListener("dragover",e=>{e.preventDefault(),g.classList.add("dragover")});g.addEventListener("dragleave",()=>{g.classList.remove("dragover")});g.addEventListener("drop",e=>{var t,n;e.preventDefault(),g.classList.remove("dragover");const r=(n=(t=e.dataTransfer)==null?void 0:t.files)==null?void 0:n[0];if(!(r!=null&&r.type.startsWith("image/")))return;const a=URL.createObjectURL(r),s=new Image;s.onload=()=>{Q(s),URL.revokeObjectURL(a)},s.src=a});
